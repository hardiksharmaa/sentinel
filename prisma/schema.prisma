// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String    @id @default(cuid())
  email     String    @unique
  name      String?
  createdAt DateTime  @default(now())
  monitors  Monitor[]
}

model Monitor {
  id          String   @id @default(cuid())
  url         String
  name        String?
  active      Boolean  @default(true)
  userId      String
  user        User     @relation(fields: [userId], references: [id])
  checks      MonitorCheck[]
  
  // Quick stats for the dashboard
  lastCheck   DateTime?
  status      String   @default("UP") // "UP" or "DOWN"

  createdAt   DateTime @default(now())
}

model MonitorCheck {
  id          String   @id @default(cuid())
  monitorId   String
  monitor     Monitor  @relation(fields: [monitorId], references: [id], onDelete: Cascade)
  
  statusCode  Int      // e.g., 200, 404, 500
  latency     Int      // Response time in ms
  
  createdAt   DateTime @default(now())

  @@index([monitorId]) // optimization for faster queries
}